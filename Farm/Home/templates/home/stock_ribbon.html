<div class="stock-ribbon" id="stock-ribbon">
    {% for product in products %}
        <span>
            {{ product.commodity }}: ₹{{ product.farmer_price }} 
            {% if product.price_change > 0 %}
                <span style="color: green;">▲{{ product.price_change }}%</span>
            {% elif product.price_change < 0 %}
                <span style="color: red;">▼{{ product.price_change }}%</span>
            {% else %}
                <span style="color: gray;">-</span>
            {% endif %}
        </span> |
    {% endfor %}
</div>

<!-- Place this script before the closing body tag -->
<script>
    function updateStockRibbon() {
        fetch("{% url 'update_ribbon' %}")  
            .then(response => response.json())
            .then(data => {
                let ribbonContent = "Latest Prices: ";
                data.forEach(item => {
                    ribbonContent += `${item.commodity}: ₹${item.latest_price} | `;
                });
                document.getElementById("stock-ribbon").innerHTML = ribbonContent;
            });
    }
    setInterval(updateStockRibbon, 5000);  // Update every 5 seconds
</script>
