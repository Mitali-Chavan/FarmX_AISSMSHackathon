<div class="stock-ribbon" id="stock-ribbon" data-url="{% url 'update_ribbon' %}">
    {% for product in products %}
        <span>
            {{ product.commodity }}: 
            <span style="color: blue;">Base ₹{{ product.baseprice }}</span> | 
            <span style="color: green;">Highest Accepted ₹{{ product.highest_farmers_accepted_price|default:"N/A" }}</span>
        </span> |
    {% endfor %}
</div>

<script>
    function updateStockRibbon() {
        let url = document.getElementById("stock-ribbon").dataset.url;

        fetch(url)
            .then(response => response.json())
            .then(data => {
                let ribbonContent = "";
                data.forEach(item => {
                    ribbonContent += `
                        <span>
                            ${item.commodity}: 
                            <span style="color: blue;">Base ₹${item.base_price}</span> | 
                            <span style="color: green;">Highest Accepted ₹${item.highest_farmers_accepted_price !== "N/A" ? item.highest_farmers_accepted_price : "item.highest_farmers_accepted_price"}</span>
                        </span> | `;
                });
                document.getElementById("stock-ribbon").innerHTML = ribbonContent;
            })
            .catch(error => console.error("Error updating stock ribbon:", error));
    }

    setInterval(updateStockRibbon, 5000);  // Update every 5 seconds
</script>
